(function(){angular.module("app",["ngMaterial","ui.router"])})();(function(){angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){c.html5Mode({enabled:!0,requireBase:!1});b.otherwise("/");a.state("collectionList",{url:"/",views:{content:{templateUrl:"app/components/collectionlist/content/collectionListContentView.html",controller:"collectionListContentController"},footer:{templateUrl:"app/components/frame/footer/frameFooterView.html"}}}).state("collection",{url:"/{collectionId:[a-z0-9]{32}}",views:{content:{templateUrl:"app/components/collection/content/collectionContentView.html",
controller:"collectionContentController"},footer:{templateUrl:"app/components/collection/footer/collectionFooterView.html",controller:"collectionFooterController"}}})}])})();(function(){angular.module("app").run(["$rootScope",function(a){a.isProgress=!1;a._progressCounter=0;a._startProgressHandler=function(){a.isProgress=!0;++a._progressCounter};a._endProgressHandler=function(){a.isProgress=0!==--a._progressCounter};a.$on("startProgress",a._startProgressHandler);a.$on("endProgress",a._endProgressHandler);a.$on("$stateChangeStart",a._startProgressHandler);a.$on("$stateChangeSuccess",a._endProgressHandler)}])})();(function(){angular.module("app").service("destroyService",function(){this.manageUnsubscribeCallbacks=function(a,b){var c=b();a.$on("$destroy",function(){for(var a=c.length,b=0;b<a;++b)c[b]()})}}).service("documentEventService",["$document",function(a){this.on=function(b,c){a.bind(b,c);return function(){a.unbind(b,c)}}}]).service("dialogService",["$mdDialog",function(a){this.alert=function(b,c,d){b=a.alert().title(b).ok(c);a.show(b)["finally"](d)};this.confirm=function(b,c,d,e,f){b=a.confirm().title(b).ok(c).cancel(d);
a.show(b).then(e,f)}}]).service("siteNavigationService",["$state",function(a){this.gotoCollectionListPage=function(){a.go("collectionList")};this.gotoCollectionPage=function(b){a.go("collection",{collectionId:b})}}]).service("dataService",["$http",function(a){this.getCollectionList=function(b,c){a.get("service.json").then(b,c)};this.getCollection=function(b,c,d){a.get("".concat(b,"/service.json")).then(c,d)}}])})();(function(){angular.module("app").controller("phraseController",["$scope","$attrs",function(a,b){a.$watch(b.data,function(b){b&&(a.phrase=b.phrase,a.phonetic=b.phonetic,a.audio=b.audio)})}])})();(function(){angular.module("app").directive("phrase",function(){return{restrict:"E",scope:!0,replace:!0,controller:"phraseController",templateUrl:"app/shared/phrase/phraseView.html"}})})();(function(){angular.module("app").controller("frameController",["$scope","$rootScope",function(a,b){a.header=null;a.footer=null;b.$on("changeHeader",function(b,d){a.header=d});b.$on("changeFooter",function(b,d){a.footer=d})}])})();(function(){angular.module("app").controller("collectionContentController",["$scope","$rootScope","$stateParams","destroyService","dialogService","siteNavigationService","dataService",function(a,b,c,d,e,f,g){a.groupStartIndex=0;a.groupEndIndex=0;a.collectionLength=0;a.GROUP_LENGTH=10;a._collectionID=null;a._collection=null;a._group=null;a._groupIndex=0;a._isExpandedGroup=!1;a.init=function(b){a._collectionID=b};a.prevGroup=function(){--a._groupIndex;a._changedGroup()};a.switchExpandedGroup=function(){a._isExpandedGroup=
!a._isExpandedGroup;a._changedGroup()};a.nextGroup=function(){++a._groupIndex;a._changedGroup()};a.shuffle=function(){a._shuffleArray(a._collection);a._isExpandedGroup=!1;a._groupIndex=0;a._changedGroup()};a._getTranslation=function(){var c=a._group.pop();a._group.length||a._generateGroup();b.$emit("changedTranslation",c)};a._changedGroup=function(){var c=Math.floor(a.collectionLength/a.GROUP_LENGTH);0>a._groupIndex?a._groupIndex=c:c<a._groupIndex&&(a._groupIndex=0);c=a._groupIndex*a.GROUP_LENGTH;
a.groupStartIndex=(a._isExpandedGroup?0:c)+1;a.groupEndIndex=Math.min(c+a.GROUP_LENGTH,a.collectionLength);a._generateGroup();a._getTranslation();b.$emit("changedGroup",a.groupStartIndex,a.groupEndIndex,a.collectionLength)};a._generateGroup=function(){a._group=a._collection.slice(a.groupStartIndex-1,a.groupEndIndex);a._shuffleArray(a._group)};a._shuffleArray=function(a){a.sort(function(){return.5-Math.random()})};a._loadData=function(){g.getCollection(c.collectionId,a._loadDataComplete,a._loadDataError);
b.$emit("startProgress")};a._loadDataComplete=function(c){b.$emit("endProgress");c=c.data;a._collection=c.collection;a._groupIndex=0;a.collectionLength=a._collection?a._collection.length:0;a._changedGroup();b.$emit("changeHeader",c.title)};a._loadDataError=function(){b.$emit("endProgress");e.confirm("Failed to load data","Try again","Back",a._loadData,f.gotoCollectionListPage)};d.manageUnsubscribeCallbacks(a,function(){return[b.$on("getTranslation",a._getTranslation),b.$on("prevGroup",a.prevGroup),
b.$on("switchExpandedGroup",a.switchExpandedGroup),b.$on("nextGroup",a.nextGroup),b.$on("shuffle",a.shuffle)]});a._loadData()}])})();(function(){angular.module("app").controller("translationController",["$scope","$rootScope","destroyService",function(a,b,c){a.translationData=null;a.isShowTranslation=!1;a._audio=new Audio("");a.playAudio=function(b){a._audio.pause();a._audio.src=b;a._audio.play()};a._playCurrentAudio=function(){var b=a.translationData.sourcePhrase.audio;b&&a.playAudio(b)};a._changedTranslationHandler=function(b,c){a.isShowTranslation=!1;a.translationData=c;a._playCurrentAudio()};a._nextHandler=function(c){a.isShowTranslation=
!a.isShowTranslation;a.isShowTranslation||b.$emit("getTranslation")};c.manageUnsubscribeCallbacks(a,function(){return[b.$on("changedTranslation",a._changedTranslationHandler),b.$on("next",a._nextHandler),b.$on("playCurrentAudio",a._playCurrentAudio)]})}])})();(function(){angular.module("app").controller("collectionFooterController",["$scope","$rootScope","$document","destroyService","documentEventService","siteNavigationService",function(a,b,c,d,e,f){a.groupStartIndex=0;a.groupEndIndex=0;a.collectionLength=0;a.prevGroup=function(){b.$emit("prevGroup")};a.nextGroup=function(){b.$emit("nextGroup")};a.switchExpandedGroup=function(){b.$emit("switchExpandedGroup")};a.next=function(a){b.$emit("next")};a.shuffle=function(){b.$emit("shuffle")};a.close=function(){f.gotoCollectionListPage()};
a._changedGroupHandler=function(b,c,d,f){a.collectionLength=f;a.groupStartIndex=c;a.groupEndIndex=d};a._keyDownHandler=function(c){switch(c.keyCode){case 13:case 32:case 40:a.next();break;case 37:a.prevGroup();break;case 38:a.switchExpandedGroup();break;case 39:a.nextGroup();break;case 17:b.$emit("playCurrentAudio")}a.$apply()};a._mouseUpHandler=function(a){c[0].activeElement.blur()};d.manageUnsubscribeCallbacks(a,function(){return[b.$on("changedGroup",a._changedGroupHandler),e.on("keydown",a._keyDownHandler),
e.on("mouseup",a._mouseUpHandler)]})}])})();(function(){angular.module("app").controller("collectionListContentController",["$scope","$rootScope","dataService","dialogService","siteNavigationService",function(a,b,c,d,e){a.collectionList=null;a.openCollection=function(a){e.gotoCollectionPage(a)};a._loadData=function(){c.getCollectionList(a._loadDataComplete,a._loadDataError);b.$emit("startProgress")};a._loadDataComplete=function(c){b.$emit("endProgress");b.$emit("changeHeader","LanguageMentor");b.$emit("changeFooter","Choose a collection");
a.collectionList=c.data};a._loadDataError=function(){b.$emit("endProgress");d.alert("Failed to load data","Try again",a._loadData)};a._loadData()}])})();